{% extends 'sidebar_base.html' %}

{% block content %}

    <div class="remodal-bg">

        <div class="col-xs-8 col-md-10 main">
            <div class="row">
                <div class="col-sm-12">
                    <h2 class="page-header" id="chat-title">{{ chat.title }}
                        {% if chat.closed %}<span class="label label-danger">Closed</span>{% endif %}
                        <br/>
                        <a href="{% url 'project_description' chat.project.id %}">
                            <small>{{ chat.project.name }}</small>
                        </a></h2>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-12">

                    <div class="row">
                        <div class="col-sm-12" align="right">
                            <ul class="nav nav-tabs">
                                <li role="presentation" class="active"><a role="tab" data-toggle="tab" href="#tab-chats">Chat</a>
                                </li>
                                <li role="presentation"><a role="tab" data-toggle="tab" href="#tab-information">Information</a></li>
                                <!-- Add metadata button -->
                                <div class="btn-group" role="group">
                                    <a href="#modal-add-metadata"><button type="button" class="btn btn-info">Add Metadata</button></a>
                                </div>
                                <!-- Options button -->
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-warning dropdown-toggle" data-toggle="dropdown" aria-expanded="false"> Options <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu pull-right" role="menu">
                                        <li><a href="#"><span class="glyphicon glyphicon-pencil"></span> Modify chat</a></li>
                                        {% if chat.closed %}
                                            <li><a href="{% url 'reopen_chat' chat.id %}"><span class="glyphicon glyphicon-repeat"></span> Reopen chat</a></li>
                                        {% else %}
                                            <li><a href="{% url 'close_chat' chat.id %}"><span class="glyphicon glyphicon-lock"></span> Close chat</a></li>
                                        {% endif %}
                                        <li class="divider"></li>
                                        <li><a href="#modal-delete"><span class="glyphicon glyphicon-remove"></span> Delete chat</a></li>
                                    </ul>
                                </div>
                            </ul>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-12">

                            <!-- Tab panes -->
                            <div class="tab-content">

                                <!-- Tab chats -->
                                <div role="tabpanel" class="tab-pane active" id="tab-chats">
                                    <div class="list-group latest-messages">
                                    </div>
                                    <input type="text" class="form-control" placeholder="Message" id="input-message">
                                </div>
                                <!-- End tab chats -->

                                <!-- Tab information -->
                                <div role="tabpanel" class="tab-pane" id="tab-information">
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <div class="panel panel-default information-panel">
                                                <div class="panel-heading">
                                                    <strong>General Information</strong>
                                                </div>
                                                <div class="panel-body">
                                                    {% if chat.closed %}
                                                        <p><strong>Status: </strong><span class="label label-danger">Closed</span>
                                                        </p>
                                                    {% else %}
                                                        <p><strong>Status: </strong><span class="label label-success">Open</span>
                                                        </p>
                                                    {% endif %}
                                                    <p><strong>Priority: </strong><span class="label label-danger">High</span>
                                                    </p>

                                                    <p><strong>Date created: </strong>{{ chat.created | date:'d/m/Y H:i' }}</p>
                                                    {% if chat.closed %}
                                                        <p><strong>Date closed: </strong>{{ chat.closed | date:'d/m/Y H:i' }}</p>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-8">
                                            <div class="panel panel-default information-panel">
                                                <div class="panel-heading">
                                                    <strong>Statistics</strong>
                                                </div>
                                                <div class="panel-body">
                                                    <p>Statistics & maybe some D3 stuff here.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <!-- End tab information -->

                                <div role="tabpanel" class="tab-pane" id="tab-users">Users content</div>
                            </div>
                            <!-- End tab panes -->


                        </div>
                    </div>

                </div>

            </div>

        </div>

        <!-- Modal window for conversation delete confirmation -->
        <div class="remodal" data-remodal-id="modal-delete">
            <h1>Are you sure?</h1>
            <p>Do you really want to delete this conversation?</p>
            <p><em>This cannot be undone.</em></p>
            <a href="{% url 'delete_chat' chat.id %}">
                <button type="button" class="btn btn-success">Yes</button>
            </a>
            <a href="#">
                <button type="button" class="btn btn-danger">No</button>
            </a>
        </div>

        <!-- Modal window for adding metadata -->
        <div class="remodal" data-remodal-id="modal-add-metadata">
            <h3>Attach metadata</h3>

            <form role="form">
                <div class="form-group" id="form-add-metadata">
                    <textarea class="form-control" rows="3" placeholder="Value of the metadata" id="metadata-value"></textarea>
                    <div class="btn-group" role="group">
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-warning dropdown-toggle" data-toggle="dropdown" aria-expanded="false" id="dropdown-metadata-name"> Select <span class="caret"></span></button>
                            <ul class="dropdown-menu" role="menu" id="list-metadata-name">
                                <!-- Ajax content inserted here -->
                            </ul>
                        </div>
                        <button type="button" class="btn btn-default" id="confirm-add-metadata">Confirm</button>
                    </div>
                </div>
            </form>

        </div>

    </div>
    <script type="text/javascript">
        CHAT_ID = "{{ chat.id }}";
        PROJECT_ID = "{{ chat.project }}";
    </script>


{% endblock %}